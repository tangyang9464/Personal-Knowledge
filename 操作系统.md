####  一、概述

1. **OS概念**
   - **目标**:方便性、有效性、可扩充性、开放性
   - **定义:**OS是控制和管理计算机硬件和软件资源、合理组织计算机工作流程以及方便用户的程序集合 (**管理资源**、**组织流程**)
   - **四个特征**:并发、共享、虚拟化、异步性
   - **五大功能**:处理机管理、存储器管理、设备管理、信息管理(文件系统管理)、作业管理
   - **三种类型**：多道批处理、分时、实时
   - **层次模型**
     - 用户接口
     - 软件集合（功能对应的软件）
     - 对象（四大资源）
2. **计算机四大资源**
   - 处理机
   - 内存
   - 外设(IO设备)
   - 信息文件

3. **用户接口**
   - 命令接口、程序接口、图形接口

#### 二、进程管理

1. **进程**（控制、同步、通信、调度）
   - **定义**:进程是程序在一个数据集合上的运行过程,是系统进行资源分配和调度的基本单位
   - **组成:**
     - **PCB**：进程标识符、处理机状态（寄存器）、调度信息、控制信息
     - 程序、数据
   - **状态**：**就绪、执行、阻塞**、结束、新（New）
   - **分类**
     - 系统进程
     - 用户进程
2. **并发执行的特点**
   - 失去程序的封闭性和可再现性
   - 程序与计算不再一一对应
   - 执行的相互制约
3. **引起进程创建的事件**
   - 用户登录、作业调度、提供服务、应用请求
4. **调度四个原则**
   - 空闲让进
   - 忙则等待
   - 有限等待
   - 让权等待
5. **进程通信方式**
   - 共享存储系统：数据结构、存储区
   - 管道通信：Unix管道
   - 消息传递系统（消息队列）：消息缓冲队列、信箱
   - 套接字
   - 信号量
6. **线程**
   - **概念**：进程中的一个实体、是系统调度的基本单位
   - **与进程区别**
     - **调度**：进程是资源分配单位、线程是调度单位
     - **并发性**：进程间并发、线程之间也能并发，引入线程后并发性更好
     - **分配资源**：拥有资源的是进程、线程本身除了一些必要资源外不拥有系统资源，但可以访问同进程的资源
     - **系统开销**：进程切换需要分配和回收资源，保存的信息也较多，开销较大；同时线程共享地址空间，通信方便，开销更小。
   - **分类**
     - **用户级线程**：用户空间实现，无需内核支持
     - **内核支持级线程**：内核空间实现，在内核支持下运行，内核空间设置线程控制块

#### 三、调度与死锁

##### 1.调度类型

- 作业调度（高级调度）
  - 提交、收容、执行、完成

- 交换调度（中级调度）（内存对换）
- 进程调度（低级调度）

##### 2.调度性能评价

- 批处理系统
  - 周转时间：完成时间 - 提交时间 = 等待时间 + 执行时间
  - 带权周转时间：周转时间 / 执行时间

##### 3.调度算法

- 先来先服务（FCFS）：适合长作业，CPU繁忙型
- 短作业优先（SJF）
- 最高响应比优先（HRRN）：1+等待 / 执行
- 时间片轮转
- 优先级调度、多级反馈队列

##### 4.死锁

- **定义**：当某进程提出资源申请后，使得系统中一些进程处于无休止的阻塞状态，在无外力作用下，永远不能再继续前进
- **原因**：
  - 系统资源不足
  - 推进顺序非法
- **产生的4个必要条件**
  - 互斥条件：资源同一时间只能有一个进程拥有
  - 不剥夺条件：资源未使用完不能被剥夺
  - 请求和保持：进程请求资源而阻塞，不释放已有资源
  - 环路等待：发生死锁的进程是环形等待的
- **解决死锁**
  - 预防死锁
    - **破坏‘请求和保持’条件**：统一分配资源，要么全部分配、要么不分配
    - 破坏‘**环路等待**’：对资源进行编号，分配时按照升序分配
  - 避免死锁（防止进入不安全状态）
    - 银行家算法

#### 四、存储器管理

##### 1. 连续分配的分区管理算法

- 首次适应算法：按照**地址递增**分区，低地址碎片多，回收开销大
- 循环首次适应算法：查找从上次位置开始，而不是从头，避免了碎片集中在低地址
- 最佳适应算法：按照**大小递增**
- 最差适应算法：**大小递减**

##### 2.分页管理

- **分页**：将进程地址空间和主存空间分成一定大小的页，称为物理块
- **页表**：地址变换机构用来存储页号和块号映射的数据结构
- **快表**：具有并行查询能力的高速缓存，用来存储正在运行进程的页号和块号映射，加快地址转换速度
- **多级页表**：将过大的单级页表拆分成多个页存储，二级页表查询两次得到块号

##### 3.分段管理

- **分段**：根据程序的逻辑内容进行分段
- **与分页区别**
  - 分页一维，分段二维
  - 分页是信息的物理单位、面向系统、大小固定；分段是信息的逻辑单位、面向用户、大小动态变化

##### 4.段页式管理

- **段页式**：对虚存分段，对物理内存分页。就是先根据程序逻辑分段，OS在自动在每个段下分页
- **优点**：保留了段式和页式的优点，提供了大量虚拟空间，提高内存利用率，减少碎片

#### 五、虚拟存储器

##### 1.虚拟存储器

- 运用请求调用和交换技术，为用户提供一个比实际容量大的多的虚拟存储器

##### 2.页面置换算法

- 最佳置换算法OPT：淘汰将长时间不用的页面
- 先进先出FIFO
- 最近最少使用LRU（时间）
- 最少使用LFU（次数）
- Clock算法：淘汰没有访问过且没修改过的

##### 3.系统抖动

- 指大量CPU时间用来进行页的调度。少部分时间进行计算

#### 六、设备管理

##### IO（数据传送）控制方式：

- 程序直接控制

- 中断
- DMA
- 通道
  - 单通路
  - 多通路

##### 设备控制器组成

- 与**处理机**的接口
- 与**设备**的接口
- IO逻辑

##### 缓冲区

- 单缓冲
- 双缓冲
- 循环缓冲
- 缓冲池
  - **操作**：提取输入、提取输出、收容输入、收容输出
  - **分类**：空白缓冲队列、装满输入数据的缓冲队列、装满输出数据的缓冲队列

##### IO系统层次

- 用户层IO软件、设备独立软件(逻辑IO系统)、设备驱动程序、中断处理程序
- **设备驱动程序**：请求I/O的进程与设备控制器之间的一个通信程序

##### 设备分配相关数据结构

- 系统设备表SDT（存储有DCT指针）
- 设备控制表DCT（设备相关信息，控制器COCT指针）
- 控制器COCT（存储有CHCT指针） 
- 通道控制表CHCT

##### 磁盘调度算法（进程调度类似）

- 先来先服务FCFS
- 最短寻道时间SSTF
- 扫描算法（电梯算法）：选择与当前磁头移动方向一致且距离最近的进程，到边后反向移动

#### 七、文件管理

##### 文件结构

###### 	逻辑结构：

- 从用户的观点出发所观察到的文件组织形式，也就是用户可以直接处理的数据及其结构

  - **类型**
    - 流式文件（无结构式）：它是有序字符的集合，文件长度等于该 文件所包含的字符数
    - 记录式文件（有结构式）
      - 顺序文件
      - 索引文件
      - Hash结构
  - **存取方法**
    - 顺序存取
    - 直接（随机）存取
    - 按键存取：线性搜索、Hash散列、二分搜索

###### 物理结构（外存分配）

- 文件在外存上的存储组织形式

  - 顺序文件：连续分配
  - 串联文件：链式分配
    - 隐式链接
    - 显示链接
  - 索引文件：建立索引表
  - 索引顺序文件

##### 文件的组成

- FCB（文件库控制块）：目录
- 文件体

##### 文件检索方法

- 顺序查找法 
- 二分查找法 
- Hash 法

##### 存储空间管理

- 空闲块链：首次适应算法
- 位示图：利用二进制的一个位来表示磁盘中一个盘块的使用情况
- 成组链接法（Unix）

##### 文件共享

- 基于索引节点
- 利用符号链

##### 文件保护

- 访问矩阵
- 存取控制表
- 访问权限表

#### 八、用户接口

- 命令接口
- 系统调用：为用户程序在执行过程中访 问系统资源而设置的一组广义指令，实现与OS的通信
  - **类型**
    - 进程控制
    - 进程通信
    - 文件操作
    - 信息维护
- 图形界面



